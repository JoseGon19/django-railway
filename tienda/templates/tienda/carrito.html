{% extends 'tienda/base.html' %}

{% block content %}
<h1 class="mb-4">Carrito de Compras</h1>

{% if cart %}
<table class="table table-bordered table-striped">
  <thead class="table-dark">
    <tr>
      <th>Producto</th>
      <th>Cantidad</th>
      <th>Precio</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    {% for item in cart %}
    <tr>
      <td>
        {% if item.producto.imagen %}
          <img src="{{ item.producto.imagen.url }}" width="60" height="60" class="me-2" style="object-fit:cover;">
        {% endif %}
        {{ item.producto.nombre }}
      </td>
      <td>{{ item.cantidad }}</td>
      <td>Q.{{ item.precio }}</td>
      <td>Q.{{ item.total }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="text-end">
  <h4>Total: <span class="fw-bold">Q.{{ cart.get_total }}</span></h4>
  {% if cart.cart %}
<form method="post" action="{% url 'finalizar_compra' %}">
    {% csrf_token %}
    <button type="submit" class="btn btn-agregar w-100 mt-3">Finalizar Compra</button>
</form>
{% endif %}
</div>

{% else %}
<div class="alert alert-info">
  Tu carrito está vacío.
</div>
{% endif %}
{% endblock %}